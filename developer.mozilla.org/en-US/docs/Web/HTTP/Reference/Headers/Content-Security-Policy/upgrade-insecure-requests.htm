<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="https://developer.mozilla.org/favicon.ico"><link rel="alternate icon" type="image/svg+xml" href="https://developer.mozilla.org/favicon.svg"><link rel="apple-touch-icon" href="https://developer.mozilla.org/apple-touch-icon.528534bba673c38049c2.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="https://developer.mozilla.org/manifest.f42880861b394dd4dc9b.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"><title>Content-Security-Policy: upgrade-insecure-requests directive</title><link rel="alternate" title="Content-Security-Policy: upgrade-insecure-requests-Direktive" href="https://developer.mozilla.org/de/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests" hreflang="de"><link rel="alternate" title="CSP: upgrade-insecure-requests" href="https://developer.mozilla.org/fr/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests" hreflang="fr"><link rel="alternate" title="CSP: upgrade-insecure-requests" href="https://developer.mozilla.org/ja/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests" hreflang="ja"><link rel="alternate" title="CSP: upgrade-insecure-requests" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests" hreflang="zh"><link rel="alternate" title="Content-Security-Policy: upgrade-insecure-requests directive" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests" hreflang="en"><link rel="preload" as="font" type="font/woff2" href="/static/media/Inter.var.c2fe3cb2b7c746f7966a.woff2" crossorigin=""><link rel="alternate" type="application/rss+xml" title="MDN Blog RSS Feed" href="https://developer.mozilla.org/en-US/blog/rss.xml"><meta name="description" content="The HTTP Content-Security-Policy (CSP)
upgrade-insecure-requests directive instructs user
agents to treat all of a site's insecure URLs (those served over HTTP) as though they
have been replaced with secure URLs (those served over HTTPS). This directive is
intended for websites with large numbers of insecure legacy URLs that need to be
rewritten."><meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests"><meta property="og:title" content="Content-Security-Policy: upgrade-insecure-requests directive - HTTP | MDN"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:description" content="The HTTP Content-Security-Policy (CSP)
upgrade-insecure-requests directive instructs user
agents to treat all of a site's insecure URLs (those served over HTTP) as though they
have been replaced with secure URLs (those served over HTTPS). This directive is
intended for websites with large numbers of insecure legacy URLs that need to be
rewritten."><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.d893525a4fb5fb1f67a2.png"><meta property="og:image:type" content="image/png"><meta property="og:image:height" content="1080"><meta property="og:image:width" content="1920"><meta property="og:image:alt" content="The MDN Web Docs logo, featuring a blue accent color, displayed on a solid black background."><meta property="og:site_name" content="MDN Web Docs"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="MozDevNet"><link rel="canonical" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/upgrade-insecure-requests"><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.on-github,.page-footer,.place,.sidebar,.top-banner,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style></head><body><div id="root"><div class="page-wrapper  category-http document-page"><div class="main-wrapper"><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><header><h1>Content-Security-Policy: upgrade-insecure-requests directive</h1><details class="baseline-indicator high"><summary><span class="indicator" role="img" aria-label="Baseline Check"></span><div class="status-title">Baseline<!-- --> <span class="not-bold">Widely available</span></div><div class="browsers"><span class="engine" title="Supported in Chrome and Edge"><span class="browser chrome supported" role="img" aria-label="Chrome check"></span><span class="browser edge supported" role="img" aria-label="Edge check"></span></span><span class="engine" title="Supported in Firefox"><span class="browser firefox supported" role="img" aria-label="Firefox check"></span></span><span class="engine" title="Supported in Safari"><span class="browser safari supported" role="img" aria-label="Safari check"></span></span></div><span class="icon icon-chevron "></span></summary><div class="extra"><p>This feature is well established and works across many devices and browser versions. Itâ€™s been available across browsers since<!-- --> <!-- -->April 2018<!-- -->.</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Baseline/Compatibility" data-glean="baseline_link_learn_more" target="_blank" class="learn-more">Learn more</a></li><li><a href="#browser_compatibility" data-glean="baseline_link_bcd_table">See full compatibility</a></li><li><a href="https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FReference%2FHeaders%2FContent-Security-Policy%2Fupgrade-insecure-requests&amp;level=high" data-glean="baseline_link_feedback" class="feedback-link" target="_blank" rel="noreferrer">Report feedback</a></li></ul></div></details></header><div class="section-content"><p>The HTTP <a href="/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a> (CSP)
<strong><code>upgrade-insecure-requests</code></strong> directive instructs user
agents to treat all of a site's insecure URLs (those served over HTTP) as though they
have been replaced with secure URLs (those served over HTTPS). This directive is
intended for websites with large numbers of insecure legacy URLs that need to be
rewritten.</p>
<div class="notecard note">
<p><strong>Note:</strong>
The <code>upgrade-insecure-requests</code> directive is evaluated before
<a href="block-all-mixed-content.htm"><code>block-all-mixed-content</code></a> and if it is set, the latter is effectively a
no-op. It is recommended to set either directive, but not both, unless you want to
force HTTPS on older browsers that do not force it after a redirect to HTTP.</p>
</div>
<p>The <code>upgrade-insecure-requests</code> directive will not ensure that users
visiting your site via links on third-party sites will be upgraded to HTTPS for the
top-level navigation and thus does not replace the
<a href="/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security"><code>Strict-Transport-Security</code></a> (<a href="https://developer.mozilla.org/en-US/docs/Glossary/HSTS">HSTS</a>) header, which
should still be set with an appropriate <code>max-age</code> to ensure that users are
not subject to SSL stripping attacks.</p></div><section aria-labelledby="syntax"><h2 id="syntax"><a href="#syntax">Syntax</a></h2><div class="section-content"><div class="code-example"><div class="example-header"><span class="language-name">http</span></div><pre class="brush: http notranslate"><code>Content-Security-Policy: upgrade-insecure-requests;
</code></pre></div></div></section><section aria-labelledby="examples"><h2 id="examples"><a href="#examples">Examples</a></h2><div class="section-content"></div></section><section aria-labelledby="using_the_http_header"><h3 id="using_the_http_header"><a href="#using_the_http_header">Using the HTTP header</a></h3><div class="section-content"><div class="code-example"><div class="example-header"><span class="language-name">http</span></div><pre class="brush: http notranslate"><code>Content-Security-Policy: upgrade-insecure-requests;
</code></pre></div></div></section><section aria-labelledby="using_the_html_meta_element"><h3 id="using_the_html_meta_element"><a href="#using_the_html_meta_element">Using the HTML meta element</a></h3><div class="section-content"><div class="code-example"><div class="example-header"><span class="language-name">html</span></div><pre class="brush: html notranslate"><code>&lt;meta
  http-equiv="Content-Security-Policy"
  content="upgrade-insecure-requests" /&gt;
</code></pre></div>
<p>With the above header set on a domain example.com that wants to migrate from HTTP to
HTTPS, non-navigational insecure resource requests are automatically upgraded
(first-party as well as third-party requests).</p>
<div class="code-example"><div class="example-header"><span class="language-name">html</span></div><pre class="brush: html notranslate"><code>&lt;img src="http://example.com/image.png" /&gt;
&lt;img src="http://not-example.com/image.png" /&gt;
</code></pre></div>
<p>These URLs will be rewritten before the request is made, meaning that no insecure
requests will hit the network. Note that, if the requested resource is not actually
available via HTTPS, the request will fail without any fallback to HTTP.</p>
<div class="code-example"><div class="example-header"><span class="language-name">html</span></div><pre class="brush: html notranslate"><code>&lt;img src="https://example.com/image.png" /&gt;
&lt;img src="https://not-example.com/image.png" /&gt;
</code></pre></div>
<p>Navigational upgrades to third-party resources brings a significantly higher potential
for breakage, these are not upgraded:</p>
<div class="code-example"><div class="example-header"><span class="language-name">html</span></div><pre class="brush: html notranslate"><code>&lt;a href="https://example.com/"&gt;Home&lt;/a&gt;
&lt;a href="http://not-example.com/"&gt;Home&lt;/a&gt;
</code></pre></div></div></section><section aria-labelledby="finding_insecure_requests"><h3 id="finding_insecure_requests"><a href="#finding_insecure_requests">Finding insecure requests</a></h3><div class="section-content"><p>With the help of the <a href="/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy-Report-Only"><code>Content-Security-Policy-Report-Only</code></a> header and
the <a href="report-uri.htm"><code>report-uri</code></a> directive, you can set-up an enforced policy and a reported
policy like this:</p>
<div class="code-example"><div class="example-header"><span class="language-name">http</span></div><pre class="brush: http notranslate"><code>Content-Security-Policy: upgrade-insecure-requests; default-src https:
Content-Security-Policy-Report-Only: default-src https:; report-uri /endpoint
</code></pre></div>
<p>That way, you still upgrade insecure requests on your secure site, but only the
monitoring policy is violated and reports insecure resources to your endpoint.</p></div></section><h2 id="specifications"><a href="#specifications">Specifications</a></h2><table class="standard-table"><thead><tr><th scope="col">Specification</th></tr></thead><tbody><tr><td><a href="https://w3c.github.io/webappsec-upgrade-insecure-requests/#delivery">Upgrade Insecure Requests<!-- --> <br><small># <!-- -->delivery</small></a></td></tr></tbody></table><!--$--><h2 id="browser_compatibility"><a href="#browser_compatibility">Browser compatibility</a></h2><lazy-compat-table></lazy-compat-table><!--/$--><section aria-labelledby="see_also"><h2 id="see_also"><a href="#see_also">See also</a></h2><div class="section-content"><ul>
<li><a href="/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a></li>
<li><a href="/en-US/docs/Web/HTTP/Reference/Headers/Upgrade-Insecure-Requests"><code>Upgrade-Insecure-Requests</code></a> header</li>
<li><a href="/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security"><code>Strict-Transport-Security</code></a> (<a href="https://developer.mozilla.org/en-US/docs/Glossary/HSTS">HSTS</a>) header</li>
<li><a href="block-all-mixed-content.htm"><code>block-all-mixed-content</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">Mixed content</a></li>
</ul></div></section></article></main></div></div></div></body></html>